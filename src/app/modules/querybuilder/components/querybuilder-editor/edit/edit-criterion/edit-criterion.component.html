<mat-card appearance="outlined" class="mat-elevation-z3">
  <mat-card-header>
    <h4>
      {{ criterion.display }}
      <em *ngFor="let termcode of criterion.termCodes">({{ termcode?.code }})</em>
    </h4>
  </mat-card-header>
  <mat-card-content>
    <mat-tab-group>
      <mat-tab label="ValueFilter" *ngIf="valueFilters.length > 0">
        <num-edit-value-definition
          *ngFor="let valueFilter; valueFilters"
          [abstractAttributeFilter]="valueFilter"
          [filterType]="'value'"
          [query]="query"
          [criterion]="criterion"
          [optional]="valueFilter.valueDefinition?.optional"
        >
        </num-edit-value-definition>
      </mat-tab>
      <mat-tab label="Attribute" *ngIf="conceptAttributeFilters.length > 0">
        <num-edit-value-definition
          *ngFor="let attributeFilter of conceptAttributeFilters"
          [abstractAttributeFilter]="attributeFilter"
          [filterType]="'attribute'"
          [query]="query"
          [criterion]="criterion"
          [optional]="attributeFilter.attributeDefinition.optional"
        >
        </num-edit-value-definition>
      </mat-tab>
      <mat-tab label="Referenzen" *ngIf="referenceAttributeFilters.length > 0">
        <num-edit-reference
          [referenceAttributes]="referenceAttributeFilters"
          [criterion]="criterion"
          [query]="query"
        ></num-edit-reference>
      </mat-tab>
      <mat-tab label="Zeitraum">
        <num-edit-time-restriction
          *ngIf="featureService.useFeatureTimeRestriction()"
          [timeRestriction]="criterion.timeRestriction"
          (doResetTimeRestriction)="resetTimeRestriction()"
        >
        </num-edit-time-restriction>
      </mat-tab>
    </mat-tab-group>
  </mat-card-content>
  <mat-card-footer>
    <div fxLayout="row" fxLayoutAlign="center center">
      <mat-form-field
        *ngIf="featureService.useFeatureMultipleGroups() && showGroups"
        appearance="outline"
        class="group-form-field"
        fxFlex="fill"
      >
        <mat-label>{{ 'QUERYBUILDER.EDIT.CHOOSE_GROUP' | translate }}</mat-label>
        <mat-select [(ngModel)]="selectedGroupId">
          <mat-option *ngFor="let group of query.groups" [value]="group.id">
            {{ group.display }}<em>({{ group.id }})</em>
          </mat-option>
        </mat-select>
      </mat-form-field>
      <div *ngIf="!(featureService.useFeatureMultipleGroups() && showGroups)" fxFlex="fill"></div>

      <num-button
        [type]="'primary'"
        (click)="doSave()"
        [isDisabled]="actionDisabled"
        class="button-save"
        >{{ 'BUTTON.' + actionButtonKey | translate }}
      </num-button>
      <num-button [type]="'primary'" (click)="doDiscard()">
        {{ 'BUTTON.CANCEL' | translate }}
      </num-button>
    </div>
  </mat-card-footer>
</mat-card>
