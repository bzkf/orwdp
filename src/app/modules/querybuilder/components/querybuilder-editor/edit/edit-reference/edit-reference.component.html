<mat-expansion-panel *ngFor="let singleReferenceCriterion of referenceCriterionsList">
  <mat-expansion-panel-header>
    <mat-panel-title fxFlex="5">
      <mat-checkbox
        [checked]="singleReferenceCriterion.isLinked"
        (click)="selectCheckboxForReference(singleReferenceCriterion); $event.stopPropagation()"
      ></mat-checkbox>
    </mat-panel-title>
    <mat-panel-title>
      {{ singleReferenceCriterion.display }}
      <em *ngFor="let termcode of criterion.termCodes">({{ termcode?.code }})</em>
    </mat-panel-title>
  </mat-expansion-panel-header>
  <mat-tab-group animationDuration="500ms">
    <mat-tab
      *ngIf="singleReferenceCriterion.attributeFilters?.length > 0"
      label="{{ 'QUERYBUILDER.EDIT.ATTRIBUTE' | translate }}"
    >
      <num-edit-value-definition
        *ngFor="let attributeFilter of singleReferenceCriterion.attributeFilters"
        [abstractAttributeFilter]="attributeFilter"
        [query]="query"
        [filterType]="'attribute'"
        [criterion]="criterion"
        [optional]="attributeFilter.attributeDefinition.optional"
      >
      </num-edit-value-definition>
    </mat-tab>
    <mat-tab label="{{ 'QUERYBUILDER.EDIT.TIMERESTRICTION.TITLE' | translate }}">
      <num-edit-time-restriction
        [timeRestriction]="singleReferenceCriterion.timeRestriction"
        (doResetTimeRestriction)="resetTimeRestriction()"
      >
      </num-edit-time-restriction>
    </mat-tab>
    <mat-tab
      *ngIf="singleReferenceCriterion.valueFilters?.length > 0"
      label="{{ 'QUERYBUILDER.EDIT.VALUE_FILTER' | translate }}"
    >
      <span *ngFor="let valueFilter of singleReferenceCriterion.valueFilters">
        <num-edit-value-definition
          *ngIf="valueFilter.valueDefinition?.selectableConcepts.length > 0"
          [abstractAttributeFilter]="valueFilter"
          [query]="query"
          [filterType]="'value'"
          [criterion]="criterion"
          [optional]="valueFilter.valueDefinition?.optional"
        >
        </num-edit-value-definition>
      </span>
    </mat-tab>
  </mat-tab-group>
</mat-expansion-panel>
